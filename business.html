<!doctype html>
<html>
    <head>
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124575724-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-124575724-1');
      </script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- HTML Meta Tags -->
        <title>Ecopush</title>
        <link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
        <meta name="description" content="">

        <!-- Google / Search Engine Tags -->
        <meta itemprop="name" content="">
        <meta itemprop="description" content="">
        <meta itemprop="image" content="">

        <!-- Facebook Meta Tags -->
        <meta property="og:url" content="/">
        <meta property="og:type" content="website">
        <meta property="og:title" content="">
        <meta property="og:description" content="">
        <meta property="og:image" content="">

        <!-- Twitter Meta Tags -->
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="">
        <meta name="twitter:description" content="">
        <meta name="twitter:image" content="">
        <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.9/css/all.css" integrity="sha384-5SOiIsAziJl6AWe0HWRKTXlfcSHKmYV4RBF18PPJ173Kzn7jzMyFuTtk8JA7QQG1" crossorigin="anonymous">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800|Poppins" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tiny-slider/2.6.0/tiny-slider.css">
        <link rel="stylesheet" href="static-src/css/styles.css">
        <link rel="author" href="humans.txt">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tiny-slider/2.6.0/min/tiny-slider.js"></script>
    </head>

    <body>
        <nav class="nav--desktop">
          <a href="https://ecopush.co" class="btn" data-hover="home">Features</a>
          <a href="https://ecopush.co/blog/" class="btn" data-hover="features">Blog</a>
          <a href="https://ecopush.co/blog/product/ecopush-plug/" class="btn" data-hover="shop">Shop</a>
          <a href="https://ecopush.co/blog/frequently-asked-questions/" class="btn" data-hover="How it works">FAQS</a>
        </nav>

        <nav class="nav--mobile">
            <div class="nav--icon"><i class="fas fa-bars"></i></div>
            <div class="mobile-list">
                <div class="centered">
                    <a href="https://ecopush.co" class="btn" data-hover="home">Features</a>
                    <a href="https://ecopush.co/blog/" class="btn" data-hover="features">Blog</a>
                    <a href="https://ecopush.co/blog/product/ecopush-plug/" class="btn" data-hover="shop">Shop</a>
                    <a href="https://ecopush.co/blog/frequently-asked-questions/" class="btn" data-hover="How it works">FAQS</a>
                </div>
            </div>
        </nav>

        <section class="section--hero">
            <div class="flex--horizontal">
                <div class="flex_child--horizontal aligner"></div>
                  <h4>Ecopush for Business</h4>
            </div>
        </section>


        <div class="light-bg">
            <section>
              <div class="row">
                <div class="col">
                  <canvas id="myChart"></canvas>
                </div>
                <div class="col2">
                  <input type="radio" name="series" value="price" checked onclick="changeSeries('price')">Best for price <br>
                  <input type="radio" name="series" value="carbon" onclick="changeSeries('carbon')">Best for CO2
                  <p>Your devices</p>
                  <div id="sliderContainer"><div>
                  <p id="savings"></p>
                  <p><- Less savings More savings -></p>
               </div>
        </div>

            </section>

            <section class="section--stats scroll-to-reveal js-section">

            </section>

            <section class="section--integrations js-section">
                <div class="section__title">
                    <h3 class="font-heading">Trusted by</h3>
                </div>
                <div class="flex--horizontal">
                    <img src="https://octopus.energy/static/consumer/img/branding/logo-black.svg" alt="Octopus Energy" class="logo">
                </div>
                <br />
                <p>Get your <strong>free</strong> Ecopush plug when you sign up to the <a href="https://ecopush.octopus.energy/" target="blank">Octopus Energy Agile Tariff</a></p>
            </section>
        </div>

        <section class="section--how-it-works js-section">
            <div class="section__container">
                <h4 class="title">How it works</h4>
            </div>
        </section>

        <section id="pre-order" class="section--pre-order js-section">
            <div class="section__title">
                <h3 class="font-heading">Contact us</h3>
            </div>
        </section>


        <script src="static-src/js/underscore-min.js"></script>
    </body>
    <script>
    var devices = [{name: "Plug1", initialValue: "1"}, {name: "Plug2", initialValue: "2"}, {name: "Plug3", initialValue: "3"}]
    var optimiseFor = "price";
      document.addEventListener("DOMContentLoaded", function() {
        var node = document.getElementById("sliderContainer")
        var container = document.createElement("div");
        container.setAttribute("class", "range");
        _.map(devices, function(device) {

          var header = document.createElement("H4");
          header.appendChild(document.createTextNode(device.name))
          container.appendChild(header);

          var slider = document.createElement("INPUT");
          slider.setAttribute("type", "range");
          slider.setAttribute("id", device.name);
          slider.setAttribute("class", "plugSlider");
          slider.setAttribute("min", "1");
          slider.setAttribute("max", "3");
          slider.setAttribute("value", device.initialValue);

          slider.setAttribute("onchange", "changeSlider()");

          container.appendChild(slider);

          var labels = document.createElement("UL");
          labels.setAttribute("class", "range");
        })
          node.appendChild(container);
          draw_graph(_.map(devices, function(device){ return get_start_index(device.initialValue)}));
      });

  function draw_graph(sliderVals) {
    var emissions = [251,252,244,242,240,240,240,241,242,240,224,234,246,252,256,255,256,257,256,261,265,262,264,262,259,255,253,251,249,242,235,237,236,238,239,240,239,237,234,232,234,226,218,197,186,179,174,165];
    var price = [6.2, 6.2, 6.2, 6.2, 5.76, 5.76, 5.62, 5.62, 6.42, 6.5, 7.2, 6.88, 7.32, 7.34, 9.4, 9.4, 9.2, 9.22, 7.74, 7.74, 7.23, 7.24, 7.31, 7.31, 6.49, 6.48, 6.4, 6.4, 6.4, 6.4, 19.54, 21.14, 23.58, 23.58, 22.95, 23, 11.3, 11.3, 8.95, 8.83, 8.4, 8, 7.3, 7.1, 7, 7.09, 7.12, 6.9];


    var series = optimiseFor == 'price' ? price : emissions;

    var charge_data = _.map(sliderVals, function(indx) { return generate_charge_data(series, indx, indx+4); } )

    var total = calculateTotal(charge_data);

    document.getElementById("savings").innerHTML = total;
    var datasets = [{
      data: series
    }
  ]
  _.map(charge_data, function(data) { datasets.push({data: data, fill: true}) })

    drawLineGraph('myChart', dayLabels(), datasets);
  }

  function get_start_index(indx) {
    if (optimiseFor == 'price') {
      switch(indx) {
         case '1': return 3;
         case '2': return 14;
         case '3': return 31;
         default: return 20;
       }
    } else {
      switch(indx) {
         case '1': return 43;
         case '2': return 6;
         case '3': return 19;
         default: return 14;
       }
    }

  }

  function changeSlider() {
    var sliders = document.getElementsByClassName("plugSlider");
    draw_graph(_.map(sliders, function(slider){ return get_start_index(slider.value)}));
  }

  function changeSeries(new_series) {
    optimiseFor = new_series;
    changeSlider();
  }

  function calc_vals(data, bucket) {
    var bob = _.chunk(data,bucket);
    return _.map(bob, listSum);
  }

  function generate_charge_data(data, start_index, end_index) {
    return _.map(data, function(val, indx) { return indx >= start_index && indx <= end_index ? data[indx] : null })
  }

  function calculateTotal(data) {
    var power = 5.8;
    var tmp = _.map(data, function(val) { return listSum(val)})
    var total = Math.floor(listSum(tmp) * power)
    var txt = "Total output " + total + " "
    var units = optimiseFor == 'price' ? "p" : "gCO2"
    return txt + units
  }

  function listSum(list) {
    var r = _.reduce(list, function(memo, num){ return memo + num; }, 0);
    return r;
  }
  function drawLineGraph(divID, labels, datasets, legend) {
    var ctx = document.getElementById(divID).getContext('2d');
    var chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: datasets
        },
        options: {
        legend: {
            display: legend,
         }
        }
    });
}
      function dayLabels() {
    return [
          "00:00", "00:30",
          "01:00", "01:30",
          "02:00", "02:30",
          "03:00", "03:30",
          "04:00", "04:30",
          "05:00", "05:30",
          "06:00", "06:30",
          "07:00", "07:30",
          "08:00", "08:30",
          "09:00", "09:30",
          "10:00", "10:30",
          "11:00", "11:30",
          "12:00", "12:30",
          "13:00", "13:30",
          "14:00", "14:30",
          "15:00", "15:30",
          "16:00", "16:30",
          "17:00", "17:30",
          "18:00", "18:30",
          "19:00", "19:30",
          "20:00", "20:30",
          "21:00", "21:30",
          "22:00", "22:30",
          "23:00", "23:30",
        ];
}
    </script>
</html>
